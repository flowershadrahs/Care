enum AppointmentStatus {
  SCHEDULED
  CHECKED_IN
  CHECKED_OUT
  COMPLETED
  CANCELLED
  NO_SHOW
}

enum AppointmentType {
  REGULAR
  WALK_IN
  EMERGENCY
  TELECONSULTATION
  FOLLOW_UP
}

model Appointment {
  id                  Int                 @id @default(autoincrement())
  uuid                String              @unique @default(uuid())
  patientId           Int
  patient             Patient             @relation("PatientAppointments", fields: [patientId], references: [id])
  doctorId            Int?
  doctor              Doctor?             @relation("DoctorAppointments", fields: [doctorId], references: [id])
  departmentId        Int?
  department          Department?         @relation(fields: [departmentId], references: [id])
  bookedById          Int?
  bookedBy            User?               @relation("BookedBy", fields: [bookedById], references: [id])
  date                DateTime
  status              AppointmentStatus   @default(SCHEDULED)
  type                AppointmentType     @default(REGULAR)
  reason              String
  notes               String?
  checkInTime         DateTime?
  checkOutTime        DateTime?
  reminderSent        Boolean             @default(false)
  reminderDate        DateTime?
  medicalRecordId     Int?
  medicalRecord       MedicalRecord?      @relation(fields: [medicalRecordId], references: [id])
  billingId           Int?
  billing             Billing?            @relation(fields: [billingId], references: [id])
  queueId             Int?                @unique
  queue               Queue?              @relation(fields: [queueId], references: [id])
  admissionId         Int?
  admission           Admission?          @relation(fields: [admissionId], references: [id])
  dischargeId         Int?
  discharge           Discharge?          @relation(fields: [dischargeId], references: [id])
  laboratoryId        Int?
  laboratory          Laboratory?         @relation(fields: [laboratoryId], references: [id])
  radiologyId         Int?
  radiology           Radiology?          @relation(fields: [radiologyId], references: [id])
  pharmacyId          Int?
  pharmacy            Pharmacy?           @relation(fields: [pharmacyId], references: [id])
  operationTheatreId  Int?
  operationTheatre    OperationTheatre?   @relation(fields: [operationTheatreId], references: [id])
  createdById         Int?
  createdBy           User?               @relation("AppointmentCreatedBy", fields: [createdById], references: [id])
  updatedById         Int?
  updatedBy           User?               @relation("AppointmentUpdatedBy", fields: [updatedById], references: [id])
  auditLogs           AuditLog[]          @relation("AppointmentAuditLogs")
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
}

model Queue {
  id                  Int                 @id @default(autoincrement())
  uuid                String              @unique @default(uuid())
  appointmentId       Int?                @unique
  appointment         Appointment?        @relation(fields: [appointmentId], references: [id])
  queueNumber         Int
  status              String              @default("WAITING") // WAITING, IN_PROGRESS, COMPLETED, SKIPPED
  priority            TriagePriority?
  departmentId        Int?
  department          Department?         @relation(fields: [departmentId], references: [id])
  estimatedWaitTime   Int?
  calledAt            DateTime?
  createdById         Int?
  createdBy           User?               @relation(fields: [createdById], references: [id])
  updatedAt           DateTime            @updatedAt
  auditLogs           AuditLog[]          @relation("QueueAuditLogs")
  createdAt           DateTime            @default(now())
}