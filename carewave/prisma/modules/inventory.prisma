enum InventoryStatus {
  IN_STOCK
  LOW_STOCK
  OUT_OF_STOCK
  EXPIRED
  DISPOSED
}

enum InventoryType {
  MEDICATION
  MEDICAL_SUPPLIES
  EQUIPMENT
  CONSUMABLES
  OTHER
}



model Inventory {
  id                    Int                 @id @default(autoincrement())
  uuid                  String              @unique @default(uuid())
  itemCode              String              @unique // e.g., "INV-001"
  name                  String              // Item name (e.g., "Paracetamol 500mg")
  description           String?             // Detailed description of item
  type                  InventoryType       // Type of inventory item
  status                InventoryStatus     @default(IN_STOCK)
  quantity              Int                 // Current quantity in stock
  minimumStockLevel     Int?                // Minimum stock threshold for alerts
  maximumStockLevel     Int?                // Maximum stock level for reordering
  unitPrice             Float?              // Cost per unit
  totalValue            Float?              @default(0.0) // Total value of stock (quantity * unitPrice)
  batchNumber           String?             // Batch number for tracking
  expiryDate            DateTime?           // Expiry date for perishable items
  purchaseDate          DateTime?           // Date of purchase
  supplierId            Int?                // Link to supplier
  supplier              InventorySupplier?           @relation(fields: [supplierId], references: [id])
  departmentId          Int?                // Link to department using the item
  department            Department?         @relation(fields: [departmentId], references: [id])
  clinicalSettingId     Int?                // Link to clinical setting
  clinicalSetting       ClinicalSetting?    @relation(fields: [clinicalSettingId], references: [id])
  pharmacyId            Int?                // Link to pharmacy for medication items
  pharmacy              Pharmacy?           @relation(fields: [pharmacyId], references: [id])
  storageLocation       String?             // Physical storage location (e.g., "Shelf A-12")
  reorderPoint          Int?                // Quantity at which to reorder
  reorderQuantity       Int?                // Quantity to order when reordering
  lastRestockedDate     DateTime?           // Last restock date
  createdById           Int?                // User who created the inventory record
  createdBy             User?               @relation("InventoryCreatedBy", fields: [createdById], references: [id])
  updatedById           Int?                // User who last updated
  updatedBy             User?               @relation("InventoryUpdatedBy", fields: [updatedById], references: [id])
  auditLogs             AuditLog[]          @relation("InventoryAuditLogs")
  inventoryTransactions InventoryTransaction[] @relation("InventoryTransactions")
  inventoryNotifications InventoryNotification[] @relation("InventoryNotifications")
  createdAt             DateTime            @default(now())
  updatedAt             DateTime            @updatedAt
}

model InventoryTransaction {
  id                    Int                 @id @default(autoincrement())
  uuid                  String              @unique @default(uuid())
  inventoryId           Int
  inventory             Inventory           @relation("InventoryTransactions", fields: [inventoryId], references: [id])
  transactionType       String
  quantity              Int
  transactionDate       DateTime            @default(now())
  reason                String?
  referenceId           Int?
  referenceType         String?
  performedById         Int?
  performedBy           User?               @relation("InventoryTransactionPerformedBy", fields: [performedById], references: [id])
  createdById           Int?
  createdBy             User?               @relation("InventoryTransactionCreatedBy", fields: [createdById], references: [id])
  updatedById           Int?
  updatedBy             User?               @relation("InventoryTransactionUpdatedBy", fields: [updatedById], references: [id])
  notes                 String?
  auditLogs             AuditLog[]          @relation("InventoryTransactionAuditLogs")
  createdAt             DateTime            @default(now())
  updatedAt             DateTime            @updatedAt
}

model InventoryNotification {
  id                    Int                 @id @default(autoincrement())
  uuid                  String              @unique @default(uuid())
  inventoryId           Int
  inventory             Inventory           @relation("InventoryNotifications", fields: [inventoryId], references: [id])
  notificationType      String              // e.g., "SMS", "Email", "App Push"
  status                NotificationStatus  @default(PENDING)
  sentAt                DateTime?
  recipientId           Int?                // User receiving notification
  recipient             User?               @relation(fields: [recipientId], references: [id])
  message               String?             // Notification content (e.g., "Low stock alert for Paracetamol")
  createdAt             DateTime            @default(now())
  updatedAt             DateTime            @updatedAt
}

model InventorySupplier {
  id                    Int                 @id @default(autoincrement())
  uuid                  String              @unique @default(uuid())
  name                  String
  contactDetails        String?
  address               String?
  supplierCode          String?             @unique
  createdById           Int?
  createdBy             User?               @relation("InventorySupplierCreatedBy", fields: [createdById], references: [id])
  updatedById           Int?
  updatedBy             User?               @relation("InventorySupplierUpdatedBy", fields: [updatedById], references: [id])
  inventory             Inventory[]         @relation
  auditLogs             AuditLog[]          @relation("SupplierAuditLogs")
  createdAt             DateTime            @default(now())
  updatedAt             DateTime            @updatedAt
}